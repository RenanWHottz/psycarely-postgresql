<!--templates/consultas/editar_consulta.html-->
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Editar Consulta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">
    <div class="container">
        <a href="{% url 'listar_consultas' consulta.paciente.id %}" class="btn btn-link">← Voltar</a>

        <h2 class="mt-3 mb-4">Editar consulta de {{ consulta.paciente.get_full_name }}</h2>

        <form method="POST" class="mt-3 shadow p-4 rounded bg-white">
            {% csrf_token %}

            <div class="mb-3">
                <label for="{{ form.data.id_for_label }}" class="form-label">Data</label>
                {{ form.data }}
            </div>

            <div class="mb-3">
                <label for="{{ form.horario.id_for_label }}" class="form-label">Horário</label>
                {{ form.horario }}
            </div>

            <div class="form-check mb-3">
                {{ form.recorrente }}
                <label class="form-check-label ms-1" for="{{ form.recorrente.id_for_label }}">Recorrente</label>
            </div>

            <div id="recorrencia-container" class="row g-3 mb-3" style="display: none;">
                <div class="col-md-6">
                    <label for="{{ form.recorrencia_valor.id_for_label }}" class="form-label">Repetir a cada</label>
                    {{ form.recorrencia_valor }}
                </div>
                <div class="col-md-6">
                    <label for="{{ form.recorrencia_unidade.id_for_label }}" class="form-label">Unidade</label>
                    {{ form.recorrencia_unidade }}
                </div>
            </div>

            <div class="d-flex justify-content-between">
                <button type="submit" class="btn btn-success px-4">Salvar</button>
                <button type="submit" name="excluir" class="btn btn-danger px-4"
                        onclick="return confirm('Tem certeza que deseja excluir esta consulta?');">Excluir</button>
            </div>
        </form>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const recorrenteCheckbox = document.getElementById('{{ form.recorrente.id_for_label }}');
                const recorrenciaContainer = document.getElementById('recorrencia-container');

                function toggleRecorrencia() {
                    recorrenciaContainer.style.display = recorrenteCheckbox.checked ? 'flex' : 'none';
                }

                recorrenteCheckbox.addEventListener('change', toggleRecorrencia);
                toggleRecorrencia();
            });
        </script>
    </div>
</body>
</html>
